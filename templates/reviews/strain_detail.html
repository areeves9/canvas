{% extends "base.html" %}
{% block head_title %}{{ strain.name }} | {{ block.super }}{% endblock head_title %}
{% block content %}

<div class="container header-container">
  <nav class="navbar navbar-expand-lg navbar-light bg-white border border-bottom-1 fixed-top">
    <a href="{{ request.META.HTTP_REFERER }}">
      <i class="fas fa-chevron-left"></i>
    </a>
    <ul class="nav navbar-nav navbar-logo mx-auto">
      <li class="nav-item text-center">
        <a class="text-dark nav-link font-weight-bold" href="#">{{ strain }}</a>
      </li>
    </ul> 
  </nav>
</div>

<div class="container">
  <div class="row mt-4">
    <div class="col-sm-6">
      <div class="card" style="position: relative !important;">
         {% include "partials/strains/strain_detail_photo.html" %}
      </div> <!--/.card-->
    </div> <!--/.col-sm-6-->
    <div class="col-sm-6">
      {% include "partials/strains/strain_card.html" %}
    </div> <!--/.col-sm-6-->
  </div> <!--/.row-->
  {% include "partials/strains/strain_detail_social.html" %}
  {% include "partials/strains/strain_detail_reviews.html" %}


<style>
  .header-container {
    padding-bottom: 65px;
  }
</style>

{% endblock %}

{% block domready %}
  $('a.strain-like').click(function(e){
    e.preventDefault();
    console.log('hello');
    $.post('{% url "reviews:strain_like" %}',
  {
    id: $(this).data('id'),
    action: $(this).data('action')
  },
    function(data){
    if (data['status'] == 'ok')
  {
    var previous_action = $('a.strain-like').data('action');
    console.log(previous_action);
    // toggle data-action
    $('a.strain-like').data('action', previous_action == 'like' ? 'unlike' : 'like');

    // toggle heart icon
    $('a.strain-like').html(previous_action == 'like' ? `<i class="fas fa-heart"></i> Unlike` : `<i class="far fa-heart"></i> Like`);

    // update total likes
    var previous_likes = parseInt($('span.count .total').text());
    $('span.count .total').text(previous_action == 'like' ? previous_likes + 1 : previous_likes - 1);
  }
    

  });
  });
  {% endblock %}
