{% extends "base.html" %}
{% block head_title %} Latest Reviews | {{ block.super }}{% endblock head_title %}
{% block content %}

<div class="container">
  {% if request.get.id != 0 %}
  <h5 class="mt-5">
    <a href="{{ strain.get_absolute_url }}">{{ strain }}</a> Reviews</h5>
  {% else %}
  <h5 class="mt-5">Latest Reviews</h5>
  {% endif %}
  <div class="row justify-content-center align-items-center">
    <div id="review-list" class="col-sm-6">
        {% include "partials/review_card.html" %}
    </div>
  </div> <!--/.row-->
</div> <!--/.container-->
{% endblock %}

{% block domready %}
var page = 1;
var empty_page = false;
var block_request = false;
$(window).scroll(function() {
  var margin = $(document).height() - $(window).height() - 200;
  if  ($(window).scrollTop() > margin && empty_page == false && block_request == false){
    block_request = true;
    page += 1;
    $.get('?page=' + page, function(data) {

      console.log('hello');

      if(data == '') {
        empty_page = true;
      } else {
        block_request = false;
        $('#review-list').append(data);
      }
         });
       }
     });
{% endblock %}
