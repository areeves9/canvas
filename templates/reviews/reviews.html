{% extends "base.html" %}
{% block head_title %} Latest Reviews | {{ block.super }}{% endblock head_title %}
{% block content %}
<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <h3>Latest Reviews</h3>
    </div> <!--/.col-xs-12-->
  </div> <!--/.row-->
  <div class="row reviews">
    <div id="review-list" class="well col-sm-12 col-lg-12">
      {% include "reviews/review_list_ajax.html" %}
    </div>  <!--/.well col-sm-12 col-lg-12-->
  </div> <!--/.row reviews-->
</div> <!--/.container-->
{% endblock %}

{% block domready %}
var page = 1;
var empty_page = false;
var block_request = false;
$(window).scroll(function() {
  var margin = $(document).height() - $(window).height() - 200;
  if  ($(window).scrollTop() > margin && empty_page == false && block_request == false){
    block_request = true;
    page += 1;
    $.get('?page=' + page, function(data) {
      if(data == '') {
        empty_page = true;
      } else {
        block_request = false;
        $('#review-list').append(data);
      }
         });
       }
     });
{% endblock %}
<!-- <div class="pagination">
     <span class="step-links">
       {% if reviews.has_previous %}
         <a href="?page={{ reviews.previous_page_number }}">previous</a>
       {% endif %}
     <span class="current">
         Page {{ reviews.number }} of {{ reviews.paginator.num_pages }}.
     </span>
       {% if reviews.has_next %}
           <a href="?page={{ reviews.next_page_number }}">next</a>
       {% endif %}
     </span>
</div>  -->
